{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container text-center mt-4">
    <p class="lead mb-4 fs-3 text-primary"><strong>SimboraDoar: A doação que você monta, a ajuda que você vê
            chegar</strong></p>
</div>

<div id="heroCarousel" class="carousel slide mb-5 shadow-lg" data-bs-ride="carousel"
    style="border-radius: 50px; overflow: hidden;">
    <div class="carousel-indicators">
        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active"></button>
        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1"></button>
        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2"></button>
    </div>
    <div class="carousel-inner">
        <!-- Slide 1: Impact Stats -->
        <div class="carousel-item active">
            <div class="position-relative d-flex align-items-center justify-content-center text-center overflow-hidden"
                style="height: 500px;">
                <!-- Background Image with Blur -->
                <div class="position-absolute w-100 h-100" style="background-image: url(&quot;{% static 'img/impact_background.jpg' %}&quot;); 
                            background-size: cover; 
                            background-position: center; 
                            transform: scale(1.1);
                            z-index: 0;">
                </div>
                <!-- Blue Gradient Overlay -->
                <div class="position-absolute w-100 h-100"
                    style="background: linear-gradient(135deg, rgba(30, 64, 175, 0.8) 0%, rgba(37, 99, 235, 0.8) 100%); z-index: 1;">
                </div>

                <div class="container text-white position-relative" style="z-index: 2;">
                    <h1 class="display-3 fw-bold mb-3">{{ total_donations }} Cestas Doadas!</h1>
                    <p class="lead mb-4 fs-3">Juntos já alimentamos centenas de famílias.</p>
                    {% if not user.is_authenticated %}
                    <a href="{% url 'register' %}"
                        class="btn btn-light btn-lg fw-bold text-primary shadow px-5 rounded-pill">Começar
                        a Doar</a>
                    {% else %}
                    <a href="{% url 'donate_options' %}"
                        class="btn btn-light btn-lg fw-bold text-primary shadow px-5 rounded-pill">Nova
                        Doação</a>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- Slide 2: Community News -->
        <div class="carousel-item">
            <div class="position-relative d-flex align-items-center justify-content-center text-center overflow-hidden"
                style="height: 500px;">
                <!-- Background Image with Blur -->
                <div class="position-absolute w-100 h-100" style="background-image: url(&quot;{% static 'img/vila_nova_bg.jpg' %}&quot;); 
                            background-size: cover; 
                            background-position: center; 
                            filter: blur(2px);
                            transform: scale(1.1);
                            z-index: 0;">
                </div>
                <!-- Green Overlay for contrast (keeping theme) -->
                <div class="position-absolute w-100 h-100"
                    style="background: linear-gradient(135deg, rgba(6, 95, 70, 0.6) 0%, rgba(16, 185, 129, 0.6) 100%); z-index: 1;">
                </div>

                <div class="container text-white position-relative" style="z-index: 2;">
                    <span class="badge bg-white text-success mb-3 px-3 py-2 rounded-pill">Notícia</span>
                    <h2 class="display-4 fw-bold">Vila Nova Esperança</h2>
                    <p class="lead fs-4">Graças às doações de novembro, 50 famílias receberam
                        mantimentos.</p>
                </div>
            </div>
        </div>
        <!-- Slide 3: Growth -->
        <div class="carousel-item">
            <div class="position-relative d-flex align-items-center justify-content-center text-center overflow-hidden"
                style="height: 500px;">
                <!-- Background Image with Blur -->
                <div class="position-absolute w-100 h-100" style="background-image: url(&quot;{% static 'img/natal_background.jpg' %}&quot;); 
                            background-size: cover; 
                            background-position: center; 
                            filter: blur(3px); 
                            transform: scale(1.1);
                            z-index: 0;">
                </div>
                <!-- Dark Overlay for contrast -->
                <div class="position-absolute w-100 h-100" style="background: rgba(76, 29, 149, 0.6); z-index: 1;">
                </div>

                <!-- Content -->
                <div class="container text-white position-relative" style="z-index: 2;">
                    <h2 class="display-4 fw-bold">Campanha de Natal</h2>
                    <p class="lead fs-4">Nossa meta é dobrar as doações até o final do ano.</p>
                    <a href="{% url 'natal_solidario' %}"
                        class="btn btn-outline-light fw-bold mt-2 px-5 rounded-pill">Saiba
                        Mais</a>
                </div>
            </div>
        </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev"
        style="z-index: 10;">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Anterior</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next"
        style="z-index: 10;">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Próximo</span>
    </button>
</div>

<div class="container">
    <div class="row text-center">
        <div class="col-md-4 mb-4">
            <div class="card h-100 p-4 text-center">
                <div class="display-4 text-primary mb-3"><i class="bi bi-cart-check"></i></div>
                <h3>Escolha sua Cesta</h3>
                <p>Opções prontas ou monte a sua personalizada com os itens que desejar.</p>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card h-100 p-4 text-center">
                <div class="display-4 text-primary mb-3"><i class="bi bi-geo-alt"></i></div>
                <h3>Rastreamento Real</h3>
                <p>Veja no mapa exatamente onde sua doação está e quando ela chega ao destino.</p>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card h-100 p-4 text-center">
                <div class="display-4 text-primary mb-3"><i class="bi bi-shield-check"></i></div>
                <h3>Transparência Total</h3>
                <p>Receba comprovantes e fotos da entrega realizada.</p>
            </div>
        </div>
    </div>
</div>

<div class="container mb-5">
    <!-- Section: Our Reality (Empathy) -->
    <div class="row mt-5 mb-5 align-items-center">
        <div class="col-lg-6">
            <h2 class="display-5 fw-bold text-primary mb-4">Nossa Realidade</h2>
            <p class="lead text-muted">No Nordeste, milhões de famílias ainda enfrentam a insegurança
                alimentar diariamente.
                A fome não espera.</p>
            <p>Sua doação não é apenas um número. É um prato de comida, é dignidade, é esperança para
                quem
                mais precisa.
                Veja o impacto que podemos causar juntos.</p>
            {% if user.is_authenticated %}
            <a href="{% url 'donate_options' %}" class="btn btn-outline-primary rounded-pill fw-bold mt-3">Faça a
                Diferença
                Agora</a>
            {% else %}
            <a href="{% url 'register' %}" class="btn btn-outline-primary rounded-pill fw-bold mt-3">Faça a
                Diferença Agora</a>
            {% endif %}
        </div>
        <div class="col-lg-6">
            <div id="realityCarousel" class="carousel slide shadow-lg rounded-4 overflow-hidden"
                data-bs-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="{% static 'img/reality_1.png' %}" class="d-block w-100" alt="Realidade 1"
                            style="height: 300px; object-fit: cover;">
                    </div>
                    <div class="carousel-item">
                        <img src="{% static 'img/reality_2.png' %}" class="d-block w-100" alt="Realidade 2"
                            style="height: 300px; object-fit: cover;">
                    </div>
                    <div class="carousel-item">
                        <img src="{% static 'img/reality_3.png' %}" class="d-block w-100" alt="Realidade 3"
                            style="height: 300px; object-fit: cover;">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section: About Us -->
    <div class="p-5 mb-5 rounded-4 shadow-sm text-center border">
        <h2 class="fw-bold mb-4 text-primary">Sobre Nós</h2>
        <p class="lead mx-auto mb-4" style="max-width: 800px;">
            O <strong>SimboraDoar</strong> nasceu com uma missão simples: conectar quem pode ajudar a quem precisa
            receber, usando a tecnologia para garantir transparência total.
        </p>
        <a href="{% url 'about' %}" class="btn btn-outline-primary rounded-pill px-4 fw-bold">Conheça Nossa História</a>
    </div>

    <!-- Section: FAQ -->
    <div class="row justify-content-center mb-5">
        <div class="col-lg-8">
            <h2 class="text-center fw-bold mb-4">Perguntas Frequentes</h2>
            <div class="accordion shadow-sm" id="faqAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse"
                            data-bs-target="#collapseOne">
                            Como sei que a doação vai chegar?
                        </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Nosso sistema possui rastreamento em tempo real via GPS. Você acompanha o
                            trajeto da cesta desde
                            a saída até a entrega.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse"
                            data-bs-target="#collapseTwo">
                            Posso escolher os itens da cesta?
                        </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Sim! Temos a opção "Montar Cesta" onde você escolhe item por item (arroz,
                            feijão, óleo, etc) e a
                            quantidade desejada.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse"
                            data-bs-target="#collapseThree">
                            Quais formas de pagamento aceitam?
                        </button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Aceitamos PIX, Cartão de Crédito e Boleto Bancário. Todas as transações são
                            seguras e
                            criptografadas.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section: Feedback -->
    <div class="mb-5">
        <h2 class="text-center fw-bold mb-4 text-primary">O que dizem nossos doadores</h2>
        <div class="row g-4">
            {% for feedback in feedbacks %}
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2"
                                style="width: 40px; height: 40px;">
                                {{ feedback.user.username|slice:":1"|upper }}
                            </div>
                            <div>
                                <h6 class="mb-0 fw-bold">{{ feedback.user.first_name|default:feedback.user.username }}
                                </h6>
                                <small class="text-muted d-block">{{ feedback.created_at|date:"d/m/Y" }}</small>
                                <span
                                    class="badge {% if feedback.user.is_superuser %}bg-warning text-dark{% else %}bg-info text-white{% endif %}">
                                    {% if feedback.user.is_superuser %}Administrador{% else %}Doador{% endif %}
                                </span>
                            </div>
                        </div>
                        <p class="card-text">"{{ feedback.message }}"</p>
                        {% if user.is_staff %}
                        <div class="text-end mt-2 border-top pt-2">
                            <a href="{% url 'delete_feedback' feedback.id %}"
                                class="btn btn-sm btn-outline-danger border-0"
                                onclick="return confirm('Tem certeza que deseja apagar este depoimento?');"
                                title="Apagar Depoimento">
                                <i class="bi bi-trash"></i> Apagar
                            </a>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12 text-center text-muted">
                <p>Seja o primeiro a deixar um depoimento!</p>
            </div>
            {% endfor %}
        </div>

        <!-- Feedback Form -->
        {% if user.is_authenticated %}
        <div class="row justify-content-center mt-5">
            <div class="col-md-8 col-lg-6">
                <div class="card shadow border-0">
                    <div class="card-body p-4 rounded-3 border">
                        <h5 class="fw-bold mb-3"><i class="bi bi-chat-heart"></i> Deixe seu Depoimento
                        </h5>
                        <form method="post">
                            {% csrf_token %}
                            <div class="mb-3">
                                {{ feedback_form.message }}
                            </div>
                            <div class="d-grid">
                                <button type="submit" name="feedback_submit" class="btn btn-primary fw-bold">Enviar
                                    Depoimento</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}